.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_auto_examples_plot_mea_pipeline.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_mea_pipeline.py:


Model Error Analysis with scikit-learn Pipeline for the Adult income dataset
============================================================================

Here we train a RandomForestClassifier to predict whether a person gains
more or less than 50k per year. This is our primary model.
Before training the primary model we preprocess the categorical and numeric
features of the dataset by means of a scikit-learn Pipeline.
Then we build a secondary model, called Model Performance Predictor (MPP),
to predict on what samples the primary model returns wrong or correct predictions.
The MPP is a DecisionTree returning a binary outcome success/failure. The leaf nodes
yielding failure outcome gather the samples mis-predicted by the primary
model. Plotting the feature distributions of these samples and comparing
to the whole data highlights the subpopulations where the model works poorly.

When using a python notebook, set ``%matplotlib inline`` to enable display.

Those are the necessary imports and initializations.


.. code-block:: python3


    from sklearn.model_selection import train_test_split
    from sklearn.ensemble import RandomForestClassifier
    from sklearn.compose import ColumnTransformer
    from sklearn.preprocessing import StandardScaler, OneHotEncoder
    from sklearn.impute import SimpleImputer
    from sklearn.pipeline import Pipeline

    import pandas as pd
    import numpy as np
    import random

    import matplotlib.image as mpimg
    import matplotlib.pyplot as plt

    from mea.error_analyzer import ErrorAnalyzer
    from mea.error_visualizer import ErrorVisualizer


    default_seed = 10
    np.random.seed(default_seed)
    random.seed(default_seed)








Load Adult income dataset.


.. code-block:: python3


    adult_income_url = 'https://www.openml.org/data/get_csv/54002/adult-census.arff'

    df = pd.read_csv(adult_income_url)

    target = 'class'

    X = df.dropna().drop(target, axis=1)
    y = df.dropna()[target]

    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

    numeric_features = df.select_dtypes(include=['int64', 'float64']).columns.tolist()
    categorical_features = df.select_dtypes(include=['object']).drop([target], axis=1).columns.tolist()

    feature_names = numeric_features + categorical_features

    print('Categorical features of the adult dataset:')
    print(categorical_features)
    print('Numeric features of the adult dataset:')
    print(numeric_features)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Categorical features of the adult dataset:
    ['workclass', 'education:', 'marital-status:', 'occupation:', 'relationship:', 'race:', 'sex:', 'native-country:']
    Numeric features of the adult dataset:
    ['ID', 'age', 'fnlwgt:', 'education-num:', 'capital-gain:', 'capital-loss:', 'hours-per-week:']




Build the preprocessing Pipeline.


.. code-block:: python3


    numeric_transformer = Pipeline(steps=[
        ('imputer', SimpleImputer(strategy='median')),
        ('scaler', StandardScaler())])
    categorical_transformer = Pipeline(steps=[
        ('imputer', SimpleImputer(strategy='constant', fill_value='missing')),
        ('onehot', OneHotEncoder(handle_unknown='ignore'))])

    preprocessor = ColumnTransformer(
        transformers=[
            ('num', numeric_transformer, numeric_features),
            ('cat', categorical_transformer, categorical_features)])

    model = Pipeline(steps=[('preprocessor', preprocessor),
                            ('classifier', RandomForestClassifier())])








Train preprocessing Pipeline and RandomForestClassifier.


.. code-block:: python3


    model.fit(X_train, y_train)

    acc_score = model.score(X_test, y_test)
    print("Acc = %.2f" % acc_score)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Acc = 0.85




Fit a Model Performance Predictor on the model performances.


.. code-block:: python3


    error_analyzer = ErrorAnalyzer(model, feature_names=feature_names)
    error_analyzer.fit(X_test, y_test)








Print metrics regarding the Model Performance Predictor.


.. code-block:: python3


    print(error_analyzer.mpp_summary(X_test, y_test, output_dict=False))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    The MPP was trained with accuracy 75.66%.
    The Decision Tree estimated the primary models accuracy to 63.24%.
    The true accuracy of the primary model is 85.15.%
    The Fidelity of the MPP is 78.09%.
    Warning: the built MPP might not be representative of the primary model performances.
    The MPP predicted model accuracy is considered too different from the true model accuracy.





Plot the Model Performance Predictor Decision Tree.


.. code-block:: python3


    error_visualizer = ErrorVisualizer(error_analyzer)
    tree_src = error_visualizer.plot_error_tree()

    # the output of ``plot_error_tree`` is rendered automatically in a python notebook
    # the following is for rendering in this sphynx gallery
    tree_src.format = 'png'
    tree_src.render('tree')
    tree_img = mpimg.imread('tree.png')

    plt.figure(figsize=(20, 20))
    plt.imshow(tree_img)
    plt.axis('off')




.. image:: /auto_examples/images/sphx_glr_plot_mea_pipeline_001.png
    :class: sphx-glr-single-img





Print the details regarding the decision tree nodes containing the majority of errors.


.. code-block:: python3


    error_analyzer.error_node_summary(leaf_selector="all_errors", add_path_to_leaves=True, print_summary=True);





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    LEAF 210:
         Correct predictions: 6 | Wrong predictions: 70 | Local error (purity): 0.92 | Global error: 0.07
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: > 195892.00
                                                      fnlwgt: <= 344639.00
                                                         ID <= 0.71
                                                            ID <= -0.13
    LEAF 286:
         Correct predictions: 4 | Wrong predictions: 63 | Local error (purity): 0.93 | Global error: 0.07
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID > 1.67
    LEAF 215:
         Correct predictions: 5 | Wrong predictions: 63 | Local error (purity): 0.92 | Global error: 0.07
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: > 10.50
                                                   age <= 34.50
    LEAF 223:
         Correct predictions: 7 | Wrong predictions: 63 | Local error (purity): 0.90 | Global error: 0.07
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: > 10.50
                                                   age > 34.50
                                                      age > 42.50
                                                         fnlwgt: > 113342.50
                                                            age <= 50.50
    LEAF 212:
         Correct predictions: 2 | Wrong predictions: 53 | Local error (purity): 0.96 | Global error: 0.06
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: > 195892.00
                                                      fnlwgt: <= 344639.00
                                                         ID > 0.71
    LEAF 263:
         Correct predictions: 5 | Wrong predictions: 57 | Local error (purity): 0.91 | Global error: 0.06
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: <= 179254.50
                                                            fnlwgt: <= 171279.50
                                                               fnlwgt: > 149447.50
                                                                  education-num: <= 9.50
    LEAF 197:
         Correct predictions: 4 | Wrong predictions: 53 | Local error (purity): 0.93 | Global error: 0.06
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: <= 195892.00
                                                      ID <= -0.77
                                                         education: == HS-grad
    LEAF 269:
         Correct predictions: 2 | Wrong predictions: 50 | Local error (purity): 0.95 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: > 179254.50
                                                            age > 37.50
                                                               ID <= 0.18
    LEAF 221:
         Correct predictions: 3 | Wrong predictions: 50 | Local error (purity): 0.93 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: > 10.50
                                                   age > 34.50
                                                      age > 42.50
                                                         fnlwgt: <= 113342.50
    LEAF 237:
         Correct predictions: 3 | Wrong predictions: 50 | Local error (purity): 0.93 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID > -1.68
                                                      ID > -1.37
                                                         age <= 34.50
    LEAF 229:
         Correct predictions: 3 | Wrong predictions: 47 | Local error (purity): 0.93 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID <= -1.68
    LEAF 172:
         Correct predictions: 4 | Wrong predictions: 43 | Local error (purity): 0.91 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age <= 29.50
                        education-num: > 9.50
                           hours-per-week: > 44.50
                              hours-per-week: <= 49.00
    LEAF 304:
         Correct predictions: 4 | Wrong predictions: 40 | Local error (purity): 0.90 | Global error: 0.04
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: > 13.50
                                 age > 58.50
    LEAF 260:
         Correct predictions: 49 | Wrong predictions: 205 | Local error (purity): 0.81 | Global error: 0.21
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: <= 179254.50
                                                            fnlwgt: <= 171279.50
                                                               fnlwgt: <= 149447.50
                                                                  fnlwgt: <= 114679.50
    LEAF 270:
         Correct predictions: 9 | Wrong predictions: 67 | Local error (purity): 0.87 | Global error: 0.07
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: > 179254.50
                                                            age > 37.50
                                                               ID > 0.18
    LEAF 239:
         Correct predictions: 8 | Wrong predictions: 60 | Local error (purity): 0.88 | Global error: 0.06
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID > -1.68
                                                      ID > -1.37
                                                         age > 34.50
                                                            education-num: <= 9.50
    LEAF 107:
         Correct predictions: 10 | Wrong predictions: 53 | Local error (purity): 0.84 | Global error: 0.06
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age <= 45.50
                        hours-per-week: > 49.00
                           workclass == Private
    LEAF 118:
         Correct predictions: 11 | Wrong predictions: 53 | Local error (purity): 0.82 | Global error: 0.06
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age > 45.50
                        occupation: == Exec-managerial
    LEAF 240:
         Correct predictions: 12 | Wrong predictions: 53 | Local error (purity): 0.81 | Global error: 0.06
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID > -1.68
                                                      ID > -1.37
                                                         age > 34.50
                                                            education-num: > 9.50
    LEAF 264:
         Correct predictions: 12 | Wrong predictions: 53 | Local error (purity): 0.81 | Global error: 0.06
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: <= 179254.50
                                                            fnlwgt: <= 171279.50
                                                               fnlwgt: > 149447.50
                                                                  education-num: > 9.50
    LEAF 186:
         Correct predictions: 7 | Wrong predictions: 43 | Local error (purity): 0.85 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: <= 32.50
                                    relationship: == Wife
                                       education-num: > 9.50
    LEAF 112:
         Correct predictions: 8 | Wrong predictions: 43 | Local error (purity): 0.84 | Global error: 0.05
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age > 45.50
                        occupation: != Exec-managerial
                           sex: != Female
                              fnlwgt: > 166317.00
    LEAF 205:
         Correct predictions: 5 | Wrong predictions: 40 | Local error (purity): 0.87 | Global error: 0.04
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: <= 195892.00
                                                      ID > -0.77
                                                         ID <= 1.21
                                                            ID > -0.27
                                                               hours-per-week: > 44.50
    LEAF 232:
         Correct predictions: 9 | Wrong predictions: 43 | Local error (purity): 0.81 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID > -1.68
                                                      ID <= -1.37
                                                         education-num: <= 9.50
    LEAF 300:
         Correct predictions: 11 | Wrong predictions: 43 | Local error (purity): 0.80 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: > 13.50
                                 age <= 58.50
                                    age > 35.50
                                       ID <= 0.62
                                          occupation: != Exec-managerial
                                             age > 41.50
                                                age <= 47.50
    LEAF 276:
         Correct predictions: 6 | Wrong predictions: 37 | Local error (purity): 0.85 | Global error: 0.04
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: > 201782.00
                                                         age <= 41.50
                                                            fnlwgt: > 232182.50
                                                               fnlwgt: <= 306525.50
                                                                  ID <= -0.12
    LEAF 218:
         Correct predictions: 7 | Wrong predictions: 37 | Local error (purity): 0.83 | Global error: 0.04
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: > 10.50
                                                   age > 34.50
                                                      age <= 42.50
                                                         ID <= 0.14
    LEAF 250:
         Correct predictions: 5 | Wrong predictions: 33 | Local error (purity): 0.85 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age <= 33.50
                                                   education-num: > 12.50
    LEAF 293:
         Correct predictions: 5 | Wrong predictions: 33 | Local error (purity): 0.85 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: > 13.50
                                 age <= 58.50
                                    age <= 35.50
                                       hours-per-week: <= 42.00
    LEAF 203:
         Correct predictions: 6 | Wrong predictions: 33 | Local error (purity): 0.84 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: <= 195892.00
                                                      ID > -0.77
                                                         ID <= 1.21
                                                            ID > -0.27
                                                               hours-per-week: <= 44.50
                                                                  ID <= 0.15
    LEAF 284:
         Correct predictions: 6 | Wrong predictions: 33 | Local error (purity): 0.84 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: > 201782.00
                                                         age > 41.50
                                                            education: != Bachelors
                                                               fnlwgt: > 225647.00
                                                                  age > 48.50
    LEAF 196:
         Correct predictions: 8 | Wrong predictions: 33 | Local error (purity): 0.79 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: <= 195892.00
                                                      ID <= -0.77
                                                         education: != HS-grad
    LEAF 135:
         Correct predictions: 6 | Wrong predictions: 30 | Local error (purity): 0.82 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: <= 8.50
                  hours-per-week: > 27.50
                     fnlwgt: <= 188742.00
                        age <= 61.50
                           age > 36.50
                              fnlwgt: > 152628.50
                                 age <= 48.50
    LEAF 277:
         Correct predictions: 7 | Wrong predictions: 26 | Local error (purity): 0.79 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: > 201782.00
                                                         age <= 41.50
                                                            fnlwgt: > 232182.50
                                                               fnlwgt: <= 306525.50
                                                                  ID > -0.12
    LEAF 170:
         Correct predictions: 13 | Wrong predictions: 47 | Local error (purity): 0.78 | Global error: 0.05
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age <= 29.50
                        education-num: > 9.50
                           hours-per-week: <= 44.50
                              ID > -0.81
                                 fnlwgt: > 177711.50
    LEAF 103:
         Correct predictions: 14 | Wrong predictions: 47 | Local error (purity): 0.77 | Global error: 0.05
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age <= 45.50
                        hours-per-week: <= 49.00
                           ID > 0.39
                              fnlwgt: > 126019.50
                                 fnlwgt: <= 214052.50
    LEAF 224:
         Correct predictions: 9 | Wrong predictions: 33 | Local error (purity): 0.77 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: > 10.50
                                                   age > 34.50
                                                      age > 42.50
                                                         fnlwgt: > 113342.50
                                                            age > 50.50
    LEAF 173:
         Correct predictions: 13 | Wrong predictions: 37 | Local error (purity): 0.73 | Global error: 0.04
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age <= 29.50
                        education-num: > 9.50
                           hours-per-week: > 44.50
                              hours-per-week: > 49.00
    LEAF 83:
         Correct predictions: 10 | Wrong predictions: 33 | Local error (purity): 0.76 | Global error: 0.03
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: > 45.50
                  relationship: != Own-child
                     fnlwgt: > 340894.50
    LEAF 234:
         Correct predictions: 10 | Wrong predictions: 30 | Local error (purity): 0.74 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID > -1.68
                                                      ID <= -1.37
                                                         education-num: > 9.50
                                                            age <= 41.50
    LEAF 317:
         Correct predictions: 11 | Wrong predictions: 30 | Local error (purity): 0.72 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: > 1836.50
                     capital-loss: > 2054.00
    LEAF 80:
         Correct predictions: 8 | Wrong predictions: 26 | Local error (purity): 0.75 | Global error: 0.03
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: > 45.50
                  relationship: != Own-child
                     fnlwgt: <= 340894.50
                        fnlwgt: <= 249840.50
                           education-num: > 7.50
                              workclass == Private
                                 age > 37.50
                                    ID <= -0.54
    LEAF 211:
         Correct predictions: 8 | Wrong predictions: 26 | Local error (purity): 0.75 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: > 195892.00
                                                      fnlwgt: <= 344639.00
                                                         ID <= 0.71
                                                            ID > -0.13
    LEAF 253:
         Correct predictions: 8 | Wrong predictions: 26 | Local error (purity): 0.75 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID <= -0.80
                                                      age <= 43.50
    LEAF 74:
         Correct predictions: 12 | Wrong predictions: 30 | Local error (purity): 0.70 | Global error: 0.03
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: > 45.50
                  relationship: != Own-child
                     fnlwgt: <= 340894.50
                        fnlwgt: <= 249840.50
                           education-num: > 7.50
                              workclass != Private
                                 ID > -0.26
    LEAF 273:
         Correct predictions: 13 | Wrong predictions: 30 | Local error (purity): 0.69 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: > 201782.00
                                                         age <= 41.50
                                                            fnlwgt: <= 232182.50
    LEAF 244:
         Correct predictions: 7 | Wrong predictions: 23 | Local error (purity): 0.76 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age <= 33.50
                                                   education-num: <= 12.50
                                                      ID <= -0.40
    LEAF 306:
         Correct predictions: 14 | Wrong predictions: 30 | Local error (purity): 0.67 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: == Farming-fishing
                              fnlwgt: <= 172469.00
    LEAF 267:
         Correct predictions: 8 | Wrong predictions: 23 | Local error (purity): 0.74 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: > 179254.50
                                                            age <= 37.50
    LEAF 116:
         Correct predictions: 8 | Wrong predictions: 23 | Local error (purity): 0.73 | Global error: 0.02
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age > 45.50
                        occupation: != Exec-managerial
                           sex: == Female
                              occupation: == Prof-specialty
                                 ID <= -0.39
    LEAF 144:
         Correct predictions: 8 | Wrong predictions: 23 | Local error (purity): 0.73 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: <= 8.50
                  hours-per-week: > 27.50
                     fnlwgt: > 188742.00
                        ID <= 0.23
                           ID > -0.87
                              ID <= -0.34
    LEAF 219:
         Correct predictions: 8 | Wrong predictions: 23 | Local error (purity): 0.73 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: > 10.50
                                                   age > 34.50
                                                      age <= 42.50
                                                         ID > 0.14
    LEAF 213:
         Correct predictions: 9 | Wrong predictions: 23 | Local error (purity): 0.72 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: > 195892.00
                                                      fnlwgt: > 344639.00
    LEAF 289:
         Correct predictions: 9 | Wrong predictions: 23 | Local error (purity): 0.72 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: > 3120.00
                                       fnlwgt: > 163788.50
    LEAF 183:
         Correct predictions: 11 | Wrong predictions: 23 | Local error (purity): 0.68 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: <= 32.50
                                    relationship: != Wife
                                       ID > 0.36
    LEAF 278:
         Correct predictions: 8 | Wrong predictions: 20 | Local error (purity): 0.71 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: > 201782.00
                                                         age <= 41.50
                                                            fnlwgt: > 232182.50
                                                               fnlwgt: > 306525.50
    LEAF 294:
         Correct predictions: 8 | Wrong predictions: 20 | Local error (purity): 0.71 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: > 13.50
                                 age <= 58.50
                                    age <= 35.50
                                       hours-per-week: > 42.00
    LEAF 247:
         Correct predictions: 8 | Wrong predictions: 20 | Local error (purity): 0.70 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age <= 33.50
                                                   education-num: <= 12.50
                                                      ID > -0.40
                                                         education: != HS-grad
                                                            fnlwgt: <= 181164.00
    LEAF 283:
         Correct predictions: 9 | Wrong predictions: 20 | Local error (purity): 0.68 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: > 201782.00
                                                         age > 41.50
                                                            education: != Bachelors
                                                               fnlwgt: > 225647.00
                                                                  age <= 48.50
    LEAF 261:
         Correct predictions: 39 | Wrong predictions: 70 | Local error (purity): 0.64 | Global error: 0.07
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: <= 179254.50
                                                            fnlwgt: <= 171279.50
                                                               fnlwgt: <= 149447.50
                                                                  fnlwgt: > 114679.50
    LEAF 158:
         Correct predictions: 15 | Wrong predictions: 30 | Local error (purity): 0.67 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age <= 29.50
                        education-num: <= 9.50
                           ID > -0.95
                              fnlwgt: <= 191712.00
                                 ID <= 1.03
    LEAF 301:
         Correct predictions: 15 | Wrong predictions: 30 | Local error (purity): 0.66 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: > 13.50
                                 age <= 58.50
                                    age > 35.50
                                       ID <= 0.62
                                          occupation: != Exec-managerial
                                             age > 41.50
                                                age > 47.50
    LEAF 310:
         Correct predictions: 17 | Wrong predictions: 30 | Local error (purity): 0.63 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age > 66.50
                           fnlwgt: > 161649.00
    LEAF 204:
         Correct predictions: 21 | Wrong predictions: 33 | Local error (purity): 0.61 | Global error: 0.03
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: <= 195892.00
                                                      ID > -0.77
                                                         ID <= 1.21
                                                            ID > -0.27
                                                               hours-per-week: <= 44.50
                                                                  ID > 0.15
    LEAF 111:
         Correct predictions: 10 | Wrong predictions: 20 | Local error (purity): 0.66 | Global error: 0.02
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age > 45.50
                        occupation: != Exec-managerial
                           sex: != Female
                              fnlwgt: <= 166317.00
    LEAF 133:
         Correct predictions: 10 | Wrong predictions: 20 | Local error (purity): 0.66 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: <= 8.50
                  hours-per-week: > 27.50
                     fnlwgt: <= 188742.00
                        age <= 61.50
                           age > 36.50
                              fnlwgt: <= 152628.50
                                 education-num: > 6.50
    LEAF 191:
         Correct predictions: 13 | Wrong predictions: 20 | Local error (purity): 0.60 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID <= -1.61
    LEAF 9:
         Correct predictions: 17 | Wrong predictions: 23 | Local error (purity): 0.58 | Global error: 0.02
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: <= 45.50
                  marital-status: != Never-married
                     fnlwgt: <= 144966.50
                        race: == White
                           marital-status: != Divorced
                              sex: != Female
    LEAF 136:
         Correct predictions: 10 | Wrong predictions: 16 | Local error (purity): 0.61 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: <= 8.50
                  hours-per-week: > 27.50
                     fnlwgt: <= 188742.00
                        age <= 61.50
                           age > 36.50
                              fnlwgt: > 152628.50
                                 age > 48.50
    LEAF 117:
         Correct predictions: 11 | Wrong predictions: 16 | Local error (purity): 0.60 | Global error: 0.02
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age > 45.50
                        occupation: != Exec-managerial
                           sex: == Female
                              occupation: == Prof-specialty
                                 ID > -0.39
    LEAF 106:
         Correct predictions: 14 | Wrong predictions: 20 | Local error (purity): 0.58 | Global error: 0.02
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age <= 45.50
                        hours-per-week: > 49.00
                           workclass != Private
    LEAF 13:
         Correct predictions: 9 | Wrong predictions: 13 | Local error (purity): 0.59 | Global error: 0.01
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: <= 45.50
                  marital-status: != Never-married
                     fnlwgt: <= 144966.50
                        race: == White
                           marital-status: != Divorced
                              sex: == Female
                                 marital-status: != Separated
                                    ID > 0.25
    LEAF 46:
         Correct predictions: 9 | Wrong predictions: 13 | Local error (purity): 0.59 | Global error: 0.01
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: <= 45.50
                  marital-status: != Never-married
                     fnlwgt: > 144966.50
                        fnlwgt: > 185547.50
                           education-num: > 8.50
                              ID > -1.14
                                 fnlwgt: > 307454.00
                                    race: == White
                                       ID > 0.57
    LEAF 168:
         Correct predictions: 9 | Wrong predictions: 13 | Local error (purity): 0.59 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age <= 29.50
                        education-num: > 9.50
                           hours-per-week: <= 44.50
                              ID > -0.81
                                 fnlwgt: <= 177711.50
                                    fnlwgt: <= 99685.00
    LEAF 185:
         Correct predictions: 9 | Wrong predictions: 13 | Local error (purity): 0.59 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: <= 32.50
                                    relationship: == Wife
                                       education-num: <= 9.50
    LEAF 235:
         Correct predictions: 9 | Wrong predictions: 13 | Local error (purity): 0.59 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: == White
                                                   ID > -1.68
                                                      ID <= -1.37
                                                         education-num: > 9.50
                                                            age > 41.50
    LEAF 227:
         Correct predictions: 10 | Wrong predictions: 13 | Local error (purity): 0.56 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID <= -0.97
                                                race: != White
    LEAF 99:
         Correct predictions: 14 | Wrong predictions: 16 | Local error (purity): 0.54 | Global error: 0.02
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age <= 45.50
                        hours-per-week: <= 49.00
                           ID <= 0.39
                              hours-per-week: > 41.00
    LEAF 22:
         Correct predictions: 11 | Wrong predictions: 13 | Local error (purity): 0.55 | Global error: 0.01
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: <= 45.50
                  marital-status: != Never-married
                     fnlwgt: <= 144966.50
                        race: == White
                           marital-status: == Divorced
                              fnlwgt: <= 105594.00
                                 age > 50.50
    LEAF 265:
         Correct predictions: 14 | Wrong predictions: 16 | Local error (purity): 0.53 | Global error: 0.02
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass == Private
                                             ID > -0.97
                                                age > 33.50
                                                   ID > -0.80
                                                      fnlwgt: <= 201782.00
                                                         fnlwgt: <= 179254.50
                                                            fnlwgt: > 171279.50
    LEAF 200:
         Correct predictions: 12 | Wrong predictions: 13 | Local error (purity): 0.51 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: > 32.50
                                    capital-gain: <= 3120.00
                                       ID <= 1.67
                                          workclass != Private
                                             ID > -1.61
                                                education-num: <= 10.50
                                                   fnlwgt: <= 195892.00
                                                      ID > -0.77
                                                         ID <= 1.21
                                                            ID <= -0.27
    LEAF 35:
         Correct predictions: 9 | Wrong predictions: 10 | Local error (purity): 0.50 | Global error: 0.01
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: <= 12.50
               hours-per-week: <= 45.50
                  marital-status: != Never-married
                     fnlwgt: > 144966.50
                        fnlwgt: > 185547.50
                           education-num: > 8.50
                              ID > -1.14
                                 fnlwgt: <= 307454.00
                                    fnlwgt: <= 228916.50
                                       education: == HS-grad
                                          fnlwgt: <= 192823.00
    LEAF 97:
         Correct predictions: 9 | Wrong predictions: 10 | Local error (purity): 0.50 | Global error: 0.01
         Path to leaf:
         marital-status: != Married-civ-spouse
            education-num: > 12.50
               age > 27.50
                  capital-gain: <= 4826.00
                     age <= 45.50
                        hours-per-week: <= 49.00
                           ID <= 0.39
                              hours-per-week: <= 41.00
                                 age > 38.50
                                    ID <= -0.95
    LEAF 129:
         Correct predictions: 9 | Wrong predictions: 10 | Local error (purity): 0.50 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: <= 8.50
                  hours-per-week: > 27.50
                     fnlwgt: <= 188742.00
                        age <= 61.50
                           age <= 36.50
                              ID > 0.24
    LEAF 181:
         Correct predictions: 9 | Wrong predictions: 10 | Local error (purity): 0.50 | Global error: 0.01
         Path to leaf:
         marital-status: == Married-civ-spouse
            capital-gain: <= 5095.50
               education-num: > 8.50
                  capital-loss: <= 1836.50
                     age > 29.50
                        age <= 66.50
                           occupation: != Farming-fishing
                              education-num: <= 13.50
                                 hours-per-week: <= 32.50
                                    relationship: != Wife
                                       ID <= 0.36
                                          age <= 46.50




Plot the feature distributions of samples in the leaf containing the majority of errors.
Rank features by correlation to error.


.. code-block:: python3

    leaf_id = error_analyzer.get_ranked_leaf_ids('all_errors')[0]
    error_visualizer.plot_feature_distributions_on_leaves(leaf_selector=leaf_id, top_k_features=3)




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/images/sphx_glr_plot_mea_pipeline_002.png
            :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/images/sphx_glr_plot_mea_pipeline_003.png
            :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/images/sphx_glr_plot_mea_pipeline_004.png
            :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Leaf 210 (Wrong prediction: 0.916, Correct prediction: 0.084)




Discussion
----------

Model Performance Predictor Metrics
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

We are dealing with a binary classification task.
Here the primary predictions of "income less or more than 50k" have been categorized
in two classes: 'Correct prediction' and 'Wrong prediction' according to the difference
from the true class. The accuracy is then the number of Correct predictions over the total.
The MPP might not be representative of the behavior of the primary model as the true primary
accuracy and the one estimated by the MPP are not close.

Model Failures
^^^^^^^^^^^^^^

Let's focus on the nodes of the MPP DecisionTree, in particular the leaf nodes
of class 'Wrong prediction'. These leaves contain the majority of errors, each
leaf clustering a subpopulation of errors with different feature values. The largest
and purest failure nodes are highlighted when printing the error node summary, and
also when plotting the feature distributions in the node (``leaf_selector="all_errors"``).
From the feature distributions, sorted by correlation with the error, we can see that
the majority of problems occur for married people with high education.
In the next iteration of model design, the primary model needs to be improved for these
subpopulations.



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  31.723 seconds)

**Estimated memory usage:**  1860 MB


.. _sphx_glr_download_auto_examples_plot_mea_pipeline.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: plot_mea_pipeline.py <plot_mea_pipeline.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: plot_mea_pipeline.ipynb <plot_mea_pipeline.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
